<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <link rel="stylesheet" href="styles/vendor.d5e73916.css">
    <link rel="stylesheet" href="styles/main.14219f9b.css">
    <base href="/">
    <link rel="icon" href="//d2c87l0yth4zbw.cloudfront.net/i/_global/favicon.png"> <!-- Open Graph data -->
    <meta property="og:title"
          content="Spotify - The Drop: Where artists release exclusive content leading up to their album drop.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://spotify-thedrop.com">
    <meta property="og:image" content="http://spotify-thedrop.com/images/facebook-share.jpg">
    <meta property="og:description"
          content="Spotify - The Drop: Where artists release exclusive content leading up to their album drop.">
    <meta property="og:site_name" content="Spotify - The Drop">
<body ng-app="dropApp" ng-class="{expanded: $root.expanded}">
<div class="site-content-container">
    <header ng-controller="HeaderCtrl" ng-include="'partials/header.html'"></header>
    <main ng-view ng-click="$root.expanded = false" ng-class="$root.view_class"></main>
    <nav class="site-mobile-navigation" ng-controller="HeaderCtrl"><a ng-repeat="link in links"
                                                                      ng-href="#{{ link.path }}"
                                                                      ng-class="{current: (path === link.path)}"
                                                                      ng-click="$root.expanded = false"> {{ link.title
        }} </a> <a ng-click="toggleShare()">SHARE</a>
        <div id="share-controls">
            <ul class="share-items">
                <li class="share-item"><a
                        href="https://www.facebook.com/sharer/sharer.php?u=http://www.spotify-thedrop.com"
                        target="_blank" class="share-button"> <i class="fa fa-facebook share-icon"></i> </a></li>
                <li class="share-item"><a href="https://twitter.com/home?status=Check%20out%20the%20drop"
                                          target="_blank" class="share-button"> <i class="fa fa-twitter share-icon"></i>
                </a></li>
                <li class="share-item"><a href="http://www.tumblr.com/share/link?url=http%3A%2F%2Fspotify-thedrop.com"
                                          target="_blank" class="share-button"> <i class="fa fa-link share-icon"></i>
                </a></li>
            </ul>
        </div>
    </nav>
</div> <!--footer ng-include="'partials/footer.html'"></footer--> <!--
    <main ng-class="$root.animationClass">

      <div class="main-content">
        <header ng-controller="HeaderCtrl" ng-include="'partials/header.html'"></header>
        <div ng-view ng-click="$root.expanded = false" ></div>
      </div>

        <nav class="mobile-navigation" ng-controller="HeaderCtrl">
            <a ng-repeat="link in links" ng-href="{{ link.path }}" ng-click="$root.expanded = false" ng-class="{current: (path === link.path)}">
                {{ link.title }}
            </a>
        </nav>

    </main> --> <!--  <main ng-class="$root.animationClass">



        <header ng-controller="HeaderCtrl" ng-include="'partials/header.html'"></header>
        <div ng-view ng-click="$root.expanded = false"></div>
    </main>

    <nav class="mobile-navigation" ng-controller="HeaderCtrl">
        <a ng-repeat="link in links" ng-href="{{ link.path }}" ng-click="$root.expanded = false" ng-class="{current: (path === link.path)}">
            {{ link.title }}
         </a>
     </nav>
 -->

<div><h1>Featured!</h1></div>
<div id="chartContainer" style="height: 300px; width: 300px;"></div>


<script type="text/javascript" src="/scripts/canvasjs.min.js"></script>
<script src="scripts/vendor.js"></script>
<script src="scripts/vendor/isotope.min.333ccf0e.js"></script>
<script src="scripts/vendor/ng-infinite-scroll.min.4042e865.js"></script>
<script src="scripts/vendor/tweenmax.min.7c9e1e5f.js"></script>
<script src="scripts/vendor/jquery.fancybox.pack.cc9e759f.js"></script>
<script src="scripts/scripts.js"></script>


<script>

//    var dps = [
//        {label: "Person1", y: 10, color: "#FF2500"},
//        {label: "Person2", y: 20, color: "#FF6000"},
//        {label: "Person3", y: 5, color: "#6B8E23"},
//        {label: "Person4", y: 15, color: "#FF6000"},
//        {label: "Person5", y: 25, color: "#6B8E23"}
//    ];

    var topUsers = [];

    var chart = new CanvasJS.Chart("chartContainer",{
        title: {
            text: "Best Rated Eaters!"
        },
        axisY: {
            suffix: " C"
        },
        legend :{
            verticalAlign: 'bottom',
            horizontalAlign: "center"
        },
        data: [
            {
                type: "column",
                bevelEnabled: true,
                indexLabel: "{y} C",
                dataPoints: topUsers
            }
        ]
    });

    function findUserInTopUsers(userName){

        var worstScoreIndex = 0;
        var worstScoreValue = -1;

        for (var i =  0; i < topUsers.length; i++){
            if (topUsers[i].label == userName){
                return topUsers[i];
            }

            if (worstScoreValue == -1 || worstScoreValue > topUsers[i].y){
                worstScoreIndex = i;
                worstScoreValue = topUsers[i].y;
            }
        }

        if (topUsers.length > 4){
            topUsers.splice(worstScoreIndex, 1);
        }
        return null;
    }

    var colors = ["#FF2500", "#FF6000", "#6B8E23"];

    var updateChart = function () {

        $.get("/get-top-scored", function(newTopUsers){


            for (var i = 0; i < newTopUsers.length; i++){
                var newItem = newTopUsers[i];
                var existingItem = findUserInTopUsers(newItem.name);
                if (existingItem == null){
                    topUsers.push({label: newItem.name,y:newItem.score,color:colors[i % colors.length]});
                }
                else{
                    existingItem.y = newItem.score;
                }
            }

            chart.render();

            setTimeout(function() {updateChart();}, updateInterval);
        });
    };

    var updateInterval = 1000;
    setTimeout(function() {updateChart();}, updateInterval);
    //    setInterval(function(){updateChart()}, updateInterval);

</script>
